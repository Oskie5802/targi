<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Targi Dashboard - SnakeAI & Ptak</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-color: #1e1e2e;
            --card-bg: #313244;
            --text-main: #cdd6f4;
            --text-muted: #a6adc8;
            --accent-snake: #89b4fa;
            --accent-ptak: #a6e3a1;
            --danger: #f38ba8;
            --warning: #f9e2af;
        }
        body { background-color: var(--bg-color); color: var(--text-main); font-family: 'Segoe UI', system-ui, sans-serif; overflow-x: hidden; }
        .navbar { background-color: #181825 !important; box-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        .nav-tabs { border-bottom: 2px solid #45475a; }
        .nav-tabs .nav-link { color: var(--text-muted); border: none; font-weight: 500; transition: all 0.2s; }
        .nav-tabs .nav-link:hover { color: #fff; }
        .nav-tabs .nav-link.active { background-color: transparent; color: var(--accent-snake); border-bottom: 2px solid var(--accent-snake); }
        .nav-link.active#ptak-tab-link { color: var(--accent-ptak); border-bottom-color: var(--accent-ptak); }
        
        .dashboard-card { background-color: var(--card-bg); border-radius: 12px; border: 1px solid #45475a; margin-bottom: 20px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .card-header { background-color: rgba(0,0,0,0.2); border-bottom: 1px solid #45475a; font-weight: 600; padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        
        .game-canvas { background: #11111b; border-radius: 8px; width: 100%; height: auto; aspect-ratio: 4/3; box-shadow: inset 0 0 20px rgba(0,0,0,0.5); }
        
        .stat-value { font-size: 2rem; font-weight: 700; color: #fff; line-height: 1.2; }
        .stat-label { font-size: 0.85rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }
        
        .btn-control { width: 100%; height: 50px; border-radius: 8px; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 10px; transition: transform 0.1s; }
        .btn-control:active { transform: scale(0.98); }
        
        /* Snake Specifics */
        .snake-theme .stat-value { color: var(--accent-snake); }
        
        /* Ptak Specifics */
        .ptak-theme .stat-value { color: var(--accent-ptak); }
        
        .camera-preview { width: 100%; aspect-ratio: 16/9; background: #000; border-radius: 8px; object-fit: cover; }
        
        .log-console { height: 150px; overflow-y: auto; font-family: 'Consolas', monospace; font-size: 0.8rem; color: #a6e3a1; background: #11111b; padding: 10px; border-radius: 6px; }
    </style>
</head>
<body>
    <nav class="navbar navbar-dark mb-4 p-3">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1"><i class="fas fa-network-wired me-2"></i>Targi Control Center</span>
            <div class="d-flex gap-3">
                <span id="snake-status" class="badge bg-secondary d-flex align-items-center"><i class="fas fa-circle me-2" style="font-size: 0.6em;"></i>Snake Offline</span>
                <span id="ptak-status" class="badge bg-secondary d-flex align-items-center"><i class="fas fa-circle me-2" style="font-size: 0.6em;"></i>Ptak Offline</span>
            </div>
        </div>
    </nav>

    <div class="container-fluid px-4">
        <ul class="nav nav-tabs mb-4" id="mainTabs">
            <li class="nav-item">
                <a class="nav-link active" id="snake-tab-link" data-bs-toggle="tab" href="#snake-tab" onclick="setActiveTheme('snake')"><i class="fas fa-cube me-2"></i>Snake AI</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="ptak-tab-link" data-bs-toggle="tab" href="#ptak-tab" onclick="setActiveTheme('ptak')"><i class="fas fa-feather-alt me-2"></i>Ptak System</a>
            </li>
        </ul>

        <div class="tab-content">
            <!-- SNAKE TAB -->
            <div class="tab-pane fade show active snake-theme" id="snake-tab">
                <div class="row">
                    <!-- Left: Game & Live Stats -->
                    <div class="col-lg-7">
                        <div class="dashboard-card">
                            <div class="card-header">
                                <span><i class="fas fa-desktop me-2"></i>Live Game Feed</span>
                                <span class="badge bg-dark" id="fps-display">-- FPS</span>
                            </div>
                            <div class="card-body p-3 text-center">
                                <img src="/api/stream/snake/mjpeg" class="game-canvas" alt="Waiting for Snake stream..." style="object-fit: contain; width: 100%; height: auto;">
                            </div>
                        </div>
                        
                        <!-- Analysis Chart -->
                        <div class="dashboard-card">
                            <div class="card-header">
                                <span><i class="fas fa-chart-line me-2"></i>Performance Analysis</span>
                            </div>
                            <div class="card-body p-3">
                                <canvas id="snake-chart" height="100"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Right: Controls & Stats -->
                    <div class="col-lg-5">
                        <!-- KPI Stats -->
                        <div class="row g-3 mb-3">
                            <div class="col-6">
                                <div class="dashboard-card p-3 text-center mb-0">
                                    <div class="stat-value" id="snake-score">0</div>
                                    <div class="stat-label">Current Score</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="dashboard-card p-3 text-center mb-0">
                                    <div class="stat-value" id="snake-gen">0</div>
                                    <div class="stat-label">Generation</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="dashboard-card p-3 text-center mb-0">
                                    <div class="stat-value" id="snake-record">0</div>
                                    <div class="stat-label">Record High</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="dashboard-card p-3 text-center mb-0">
                                    <div class="stat-value" id="snake-mean">0.0</div>
                                    <div class="stat-label">Mean Score (L100)</div>
                                </div>
                            </div>
                        </div>

                        <!-- Controls -->
                        <div class="dashboard-card">
                            <div class="card-header">Control Panel</div>
                            <div class="card-body p-4">
                                <label class="form-label text-muted text-uppercase small fw-bold">Simulation Speed</label>
                                <div class="d-flex align-items-center mb-4">
                                    <input type="range" class="form-range flex-grow-1" min="5" max="120" id="fps-slider" oninput="updateFPSDisplay()" onchange="sendSettings()">
                                    <span class="ms-3 badge bg-primary" id="fps-val-badge">30</span>
                                </div>

                                <div class="row g-2">
                                    <div class="col-6">
                                        <button class="btn btn-warning btn-control" onclick="togglePause()" id="pause-btn">
                                            <i class="fas fa-pause"></i> Pause
                                        </button>
                                    </div>
                                    <div class="col-6">
                                        <button class="btn btn-danger btn-control" onclick="sendCommand('RESET')">
                                            <i class="fas fa-redo"></i> Reset
                                        </button>
                                    </div>
                                    <div class="col-12 mt-2">
                                        <button class="btn btn-success btn-control" onclick="sendCommand('SAVE_MODEL')">
                                            <i class="fas fa-save"></i> Save Model Checkpoint
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">System Log</div>
                            <div class="log-console" id="log-console">
                                <div>[SYS] Dashboard initialized...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PTAK TAB -->
            <div class="tab-pane fade ptak-theme" id="ptak-tab">
                <div class="row">
                    <!-- Left: Live Views -->
                    <div class="col-lg-6">
                        <!-- Game Preview -->
                        <div class="dashboard-card">
                            <div class="card-header bg-success text-white">
                                <span><i class="fas fa-gamepad me-2"></i>Live Game View</span>
                            </div>
                            <div class="card-body p-0 bg-black text-center">
                                <img src="/api/stream/ptak/mjpeg" style="width:100%; height:300px; object-fit: contain;" alt="Waiting for Ptak stream...">
                            </div>
                        </div>
                        
                        <!-- Camera Preview (Pose) -->
                        <div class="dashboard-card">
                            <div class="card-header bg-info text-dark">
                                <span><i class="fas fa-camera me-2"></i>Computer Vision Feed</span>
                            </div>
                            <div class="card-body p-0 bg-black text-center">
                                <img src="/api/stream/ptak/camera/mjpeg" style="width:100%; height:300px; object-fit: contain;" alt="Waiting for Camera stream...">
                            </div>
                        </div>
                    </div>

                    <!-- Right: Leaderboard & Media -->
                    <div class="col-lg-6">
                        <div class="dashboard-card" style="height: 660px;">
                            <div class="card-header">
                                <ul class="nav nav-pills card-header-pills">
                                    <li class="nav-item">
                                        <a class="nav-link active" data-bs-toggle="pill" href="#p-media">Media Gallery</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="pill" href="#p-leaderboard">Leaderboard</a>
                                    </li>
                                </ul>
                                <button class="btn btn-sm btn-outline-light" onclick="loadMedia()"><i class="fas fa-sync"></i></button>
                            </div>
                            <div class="card-body overflow-auto" style="height: 580px;">
                                <div class="tab-content">
                                    <div class="tab-pane fade show active" id="p-media">
                                        <div class="row g-2" id="media-grid">
                                            <!-- Media Items -->
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="p-leaderboard">
                                        <iframe src="/leaderboard" style="width:100%; height:550px; border:none;"></iframe>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
=======
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake AI Dashboard</title>
    <style>
        body {
            background-color: #1e1e2e; /* Dark background */
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            height: 100vh;
            box-sizing: border-box;
        }

        /* Header Area with Tabs and Speed */
        .header-area {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .tabs-container {
            display: flex;
            gap: 10px;
        }

        .tab-btn {
            background-color: #45475a; /* Dark gray */
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            transition: background-color 0.2s;
        }

        .tab-btn.active {
            background-color: #585b70; /* Slightly lighter for active? Or just standard style */
            border: 1px solid #7f849c;
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .speed-label {
            font-size: 14px;
            color: #cdd6f4;
            margin-right: 5px;
        }

        .speed-btn {
            background-color: #45475a;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        
        .speed-btn:active {
            transform: translateY(2px);
        }

        /* Focus Area */
        .focus-area {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
        }

        .focus-label {
            color: #cdd6f4;
            font-size: 16px;
            margin-right: 5px;
        }

        .focus-btn {
            background-color: #45475a;
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            transition: all 0.2s;
        }

        .focus-btn.active {
            background-color: #facc15; /* Bright Yellow */
            color: black;
            font-weight: bold;
        }

        /* Main Content Area (Placeholder for where the view would be if it was in dashboard, 
           but based on request, this controls the external game monitor. 
           We can keep the stream here too if needed, but the UI request focused on controls) */
        .main-content {
            flex-grow: 1;
            background-color: #11111b;
            border-radius: 16px;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            border: 1px solid #313244;
        }
        
        .game-stream {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        /* Bottom Action Buttons */
        .action-area {
            display: flex;
            justify-content: flex-end; /* Align to right as per image? Image showed bottom right */
            gap: 15px;
        }

        .action-btn {
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.4);
            text-transform: uppercase;
        }

        .btn-pause {
            background-color: #4ade80; /* Green */
        }

        .btn-save {
            background-color: #60a5fa; /* Blue */
        }

        .btn-help {
            background-color: #7f5af0; /* Purple (approx) */
            padding: 12px 20px; /* Smaller width for ? */
        }
        
        /* Help modal */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            align-items: center; justify-content: center;
        }
        .modal-content {
            background: #313244;
            padding: 30px;
            border-radius: 12px;
            max-width: 500px;
        }

    </style>
</head>
<body>

    <!-- Header: Tabs and Speed -->
    <div class="header-area">
        <div class="tabs-container">
            <button class="tab-btn active" onclick="switchTab('focus')">Focus View</button>
            <button class="tab-btn" onclick="switchTab('analytics')">Analytics</button>
        </div>

        <div class="speed-control">
            <span class="speed-label">Speed</span>
            <button class="speed-btn" onclick="changeSpeed(-5)">-</button>
            <button class="speed-btn" onclick="changeSpeed(5)">+</button>
        </div>
    </div>

    <!-- Focus Selectors -->
    <div class="focus-area">
        <span class="focus-label">Focus:</span>
        <button class="focus-btn active" id="btn-focus-0" onclick="setFocus(0)">1</button>
        <button class="focus-btn" id="btn-focus-1" onclick="setFocus(1)">2</button>
        <button class="focus-btn" id="btn-focus-2" onclick="setFocus(2)">3</button>
        <button class="focus-btn" id="btn-focus-3" onclick="setFocus(3)">4</button>
        <button class="focus-btn" id="btn-focus-4" onclick="setFocus(4)">5</button>
        <button class="focus-btn" id="btn-focus-5" onclick="setFocus(5)">6</button>
    </div>

    <!-- Main Content (Stream) -->
    <div class="main-content" id="main-view">
        <img src="/api/stream/snake/mjpeg" class="game-stream" alt="Stream loading...">
    </div>
    
    <!-- Analytics Content (Hidden by default) -->
    <div class="main-content" id="analytics-view" style="display: none; color: #a6adc8; flex-direction: column; padding: 20px;">
        <h3>Performance Analytics</h3>
        <p>Current Score: <span id="stat-score" style="color: white; font-weight: bold;">0</span></p>
        <p>Generation: <span id="stat-gen" style="color: white; font-weight: bold;">0</span></p>
        <div style="flex-grow: 1; display: flex; align-items: center; justify-content: center; border: 1px dashed #45475a; margin-top: 20px; border-radius: 8px;">
            Analytics Chart Placeholder
        </div>
    </div>

    <!-- Bottom Actions -->
    <div class="action-area">
        <button class="action-btn btn-pause" onclick="togglePause()" id="btn-pause">PAUSE</button>
        <button class="action-btn btn-save" onclick="saveModel()">SAVE</button>
        <button class="action-btn btn-help" onclick="toggleHelp()">?</button>
    </div>

    <!-- Help Modal -->
    <div class="modal" id="help-modal" onclick="toggleHelp()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h3>Controls Help</h3>
            <ul>
                <li><b>Focus 1-6:</b> Switch main view to specific agent and maximize it on game screen.</li>
                <li><b>Speed +/-:</b> Adjust simulation speed (FPS).</li>
                <li><b>PAUSE:</b> Freeze/Resume simulation.</li>
                <li><b>SAVE:</b> Force save current model checkpoint.</li>
            </ul>
            <button class="action-btn btn-save" style="width: 100%; margin-top: 20px;" onclick="toggleHelp()">Close</button>
>>>>>>> 828a40c (update 02-19 22:45)
        </div>
    </div>

    <script>
        // --- UTILS ---
        function log(msg) {
            const c = document.getElementById('log-console');
            const d = document.createElement('div');
            d.innerText = `> ${msg}`;
            c.appendChild(d);
            c.scrollTop = c.scrollHeight;
        }

        function setActiveTheme(theme) {
            const tabs = document.querySelectorAll('.nav-link');
            tabs.forEach(t => t.classList.remove('active'));
            document.getElementById(theme+'-tab-link').classList.add('active');
        }

        // --- CHART SETUP ---
        const ctxChart = document.getElementById('snake-chart').getContext('2d');
        const snakeChart = new Chart(ctxChart, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Score History',
                    data: [],
                    borderColor: '#89b4fa',
                    backgroundColor: 'rgba(137, 180, 250, 0.1)',
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: { grid: { color: '#45475a' }, ticks: { color: '#a6adc8' } },
                    x: { display: false }
                }
            }
        });

        // --- SNAKE LOGIC ---
        // Removed canvas drawing logic in favor of MJPEG stream
        
        // Snake Polling (Only Stats)
        let currentFocus = 0;
        let isPaused = false;
        let currentSpeed = 30;

        // Init
        fetchSettings();

        function setFocus(index) {
            // Update UI
            document.querySelectorAll('.focus-btn').forEach((btn, idx) => {
                if (idx === index) btn.classList.add('active');
                else btn.classList.remove('active');
            });
            
            currentFocus = index;
            
            // Send Command
            sendCommand(`FOCUS_${index}`);
        }

        function changeSpeed(delta) {
            currentSpeed += delta;
            if (currentSpeed < 5) currentSpeed = 5;
            if (currentSpeed > 120) currentSpeed = 120;
            
            fetch('/api/snake/settings', { 
                method: 'POST', 
                headers:{'Content-Type':'application/json'}, 
                body: JSON.stringify({fps: currentSpeed})
            });
        }

        function togglePause() {
            isPaused = !isPaused;
            updatePauseBtn();
            
            fetch('/api/snake/settings', { 
                method: 'POST', 
                headers:{'Content-Type':'application/json'}, 
                body: JSON.stringify({paused: isPaused})
            });
        }
        
        function updatePauseBtn() {
            const btn = document.getElementById('btn-pause');
            if (isPaused) {
                btn.innerText = "RESUME";
                btn.style.backgroundColor = "#eab308"; // Yellow-ish for resume
            } else {
                btn.innerText = "PAUSE";
                btn.style.backgroundColor = "#4ade80"; // Green
            }
        }

        function saveModel() {
            sendCommand('SAVE_MODEL');
            alert('Save command sent!');
        }

        function toggleHelp() {
            const modal = document.getElementById('help-modal');
            modal.style.display = modal.style.display === 'flex' ? 'none' : 'flex';
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            if (tab === 'focus') {
                document.querySelector('.tab-btn:first-child').classList.add('active');
                document.getElementById('main-view').style.display = 'flex';
                document.getElementById('analytics-view').style.display = 'none';
            } else {
                document.querySelector('.tab-btn:last-child').classList.add('active');
                document.getElementById('main-view').style.display = 'none';
                document.getElementById('analytics-view').style.display = 'flex';
            }
        }

        function sendCommand(cmd) {
            fetch('/api/snake/command', { 
                method: 'POST', 
                headers:{'Content-Type':'application/json'}, 
                body: JSON.stringify({command: cmd})
            });
        }
        
        function fetchSettings() {
            fetch('/api/snake/settings')
                .then(r => r.json())
                .then(data => {
                    if(data.fps) currentSpeed = data.fps;
                    if(data.paused !== undefined) {
                        isPaused = data.paused;
                        updatePauseBtn();
                    }
                });
        }

        // Polling for stats
        setInterval(() => {
            fetch('/api/snake/state')
                .then(r => r.json())
                .then(data => {
                    snakeState = data;
                    document.getElementById('snake-score').innerText = data.score;
                    document.getElementById('snake-gen').innerText = data.n_games;
                    
                    document.getElementById('snake-status').className = 'badge bg-success d-flex align-items-center';
                    document.getElementById('snake-status').innerHTML = '<i class="fas fa-circle me-2" style="font-size: 0.6em;"></i>Snake Online';
                    
                    // Update Chart occasionally
                    if (Math.random() < 0.1 && snakeChart.data.datasets[0].data.length < 50) {
                        snakeChart.data.labels.push(data.n_games);
                        snakeChart.data.datasets[0].data.push(data.score);
                        snakeChart.update();
                    }
                })
                .catch(() => {
                    document.getElementById('snake-status').className = 'badge bg-secondary d-flex align-items-center';
                    document.getElementById('snake-status').innerHTML = '<i class="fas fa-circle me-2" style="font-size: 0.6em;"></i>Snake Offline';
                });
        }, 500); // Slower polling for stats since video is separate

        // --- PTAK LOGIC ---
        let ptakState = {};

        setInterval(() => {
            fetch('/api/ptak/state')
                .then(r => r.json())
                .then(data => {
                    ptakState = data;
                    document.getElementById('ptak-status').className = 'badge bg-success d-flex align-items-center';
                    document.getElementById('ptak-status').innerHTML = '<i class="fas fa-circle me-2" style="font-size: 0.6em;"></i>Ptak Online';
                })
                .catch(() => {
                    document.getElementById('ptak-status').className = 'badge bg-secondary d-flex align-items-center';
                    document.getElementById('ptak-status').innerHTML = '<i class="fas fa-circle me-2" style="font-size: 0.6em;"></i>Ptak Offline';
                });
        }, 200); // 5 FPS polling for stats

        // --- MEDIA ---

        // --- MEDIA ---
        function loadMedia() {
            fetch('/api/media')
                .then(r => r.json())
                .then(items => {
                    const grid = document.getElementById('media-grid');
                    grid.innerHTML = '';
                    if(!items || items.length === 0) {
                        grid.innerHTML = '<div class="col-12 text-muted text-center py-5">No media captured yet</div>';
                        return;
                    }
                    items.forEach(item => {
                        const col = document.createElement('div');
                        col.className = 'col-6 col-md-4 mb-2';
                        let content = '';
                        if (item.type === 'video') {
                            content = `<video src="/uploads/${item.filename}" class="camera-preview" controls></video>`;
                        } else {
                            content = `<img src="/uploads/${item.filename}" class="camera-preview">`;
                        }
                        
                        const nameDisplay = item.name === '-' ? '<i>(Auto)</i>' : `<b>${item.name}</b>`;
                        
                        col.innerHTML = `
                            <div class="card bg-dark border-secondary">
                                ${content}
                                <div class="card-footer p-2 d-flex justify-content-between align-items-center">
                                    <div style="font-size: 0.8rem; line-height: 1.2;">
                                        ${nameDisplay}<br>
                                        <span class="text-warning">Score: ${item.score}</span>
                                    </div>
                                    <button class="btn btn-xs btn-outline-danger" style="font-size: 0.7em" onclick="deleteMedia('${item.filename}')"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                        `;
                        grid.appendChild(col);
                    });
                });
        }
        
        function deleteMedia(f) {
            if(confirm('Delete?')) fetch(`/api/media/${f}`, {method:'DELETE'}).then(loadMedia);
        }

        // --- SNAKE CONTROLS ---
        function sendCommand(cmd) {
            fetch('/api/snake/command', { method: 'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({command: cmd})});
        }
        function togglePause() {
            snakeState.paused = !snakeState.paused;
            fetch('/api/snake/settings', { method: 'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({paused: snakeState.paused})});
            document.getElementById('pause-btn').innerHTML = snakeState.paused ? '<i class="fas fa-play"></i> Resume' : '<i class="fas fa-pause"></i> Pause';
        }
        function updateFPSDisplay() {
            document.getElementById('fps-val-badge').innerText = document.getElementById('fps-slider').value;
        }
        function sendSettings() {
            fetch('/api/snake/settings', { method: 'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({fps: parseInt(document.getElementById('fps-slider').value)})});
        }

        // Init
        loadMedia();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
=======
                    document.getElementById('stat-score').innerText = data.score;
                    document.getElementById('stat-gen').innerText = data.n_games;
                });
        }, 1000);

    </script>
>>>>>>> 828a40c (update 02-19 22:45)
</body>
</html>
